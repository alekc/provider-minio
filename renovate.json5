{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "mergeConfidence:all-badges",
    "config:recommended"
  ],
  "prConcurrentLimit": 15,
  "baseBranchPatterns": [
    "main"
  ],
  "ignorePaths": [
    "design/**"
  ],
  "postUpdateOptions": [
    "gomodTidy"
  ],
  "semanticCommits": "disabled",
  "labels": [
    "automated"
  ],
  "customManagers": [
    {
      "customType": "regex",
      "managerFilePatterns": [
        "/^\\.github\\/workflows\\/[^/]+\\.ya?ml$/"
      ],
      "matchStrings": [
        "GO_VERSION: '(?<currentValue>.*?)'\\n"
      ],
      "datasourceTemplate": "golang-version",
      "depNameTemplate": "golang"
    },
    {
      "customType": "regex",
      "managerFilePatterns": [
        "/^\\.github\\/workflows\\/[^/]+\\.ya?ml$/"
      ],
      "matchStrings": [
        "GOLANGCI_VERSION: '(?<currentValue>.*?)'\\n"
      ],
      "datasourceTemplate": "github-tags",
      "depNameTemplate": "golangci/golangci-lint"
    }
  ],
  // PackageRules disabled below should be enabled in case of vulnerabilities
  "vulnerabilityAlerts": {
    "enabled": true
  },
  "packageRules": [
    {
      // We need to ignore k8s.io/client-go older versions as they switched to
      // semantic version and old tags are still available in the repo.
      "matchDatasources": [
        "go"
      ],
      "matchDepNames": [
        "k8s.io/client-go"
      ],
      "allowedVersions": "<1.0"
    }, {
      // We want a single PR for all the patches bumps of kubernetes related
      // dependencies, as most of the times these are all strictly related.
      "matchDatasources": [
        "go"
      ],
      "groupName": "kubernetes patches",
      "matchUpdateTypes": [
        "patch",
        "digest"
      ],
      "matchPackageNames": [
        "k8s.io{/,}**",
        "sigs.k8s.io{/,}**"
      ]
    }, {
      // We want dedicated PRs for each minor and major bumps to kubernetes related
      // dependencies.
      "matchDatasources": [
        "go"
      ],
      "matchUpdateTypes": [
        "major",
        "minor"
      ],
      "matchPackageNames": [
        "k8s.io{/,}**",
        "sigs.k8s.io{/,}**"
      ]
    }, {
      // We want dedicated PRs for each bump to non-kubernetes Go dependencies, but
      // only if there are known vulnerabilities in the current version.
      "matchDatasources": [
        "go"
      ],
      "enabled": false,
      "matchUpdateTypes": [
        "major"
      ],
      "matchPackageNames": [
        "*",
        "!k8s.io{/,}**",
        "!sigs.k8s.io{/,}**"
      ]
    },
    {
      "matchDatasources": [
        "go"
      ],
      "enabled": false,
      "matchUpdateTypes": [
        "minor",
        "patch",
        "digest"
      ],
      "groupName": "all non-major go dependencies",
      "matchPackageNames": [
        "*",
        "!k8s.io{/,}**",
        "!sigs.k8s.io{/,}**"
      ]
    },
    {
      // Group ALL GitHub Action updates (major, minor, patch, digest) into a single PR
      "matchDepTypes": [
        "action"
      ],
      "groupName": "all github actions",
      "pinDigests": true
    }
  ]
}